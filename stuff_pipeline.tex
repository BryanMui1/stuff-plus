% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[left=0.3in, right=0.3in, top=0.3in, bottom=0.3in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
\DefineVerbatimEnvironment{OutputCode}{Verbatim}{breaklines,commandchars=\\\{\}}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={stuff\_pipeline},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{stuff\_pipeline}
\author{}
\date{}

\begin{document}
\maketitle


Stuff pipeline: Reads in the csv, outputs a cleaned dataset

Combining the Datasets

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{777}\NormalTok{)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
v dplyr     1.1.4     v readr     2.1.5
v forcats   1.0.0     v stringr   1.5.1
v ggplot2   3.5.2     v tibble    3.2.1
v lubridate 1.9.4     v tidyr     1.3.1
v purrr     1.0.4     
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(xgboost)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Attaching package: 'xgboost'

The following object is masked from 'package:dplyr':

    slice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(recipes)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Attaching package: 'recipes'

The following object is masked from 'package:stringr':

    fixed

The following object is masked from 'package:stats':

    step
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(mgcv)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: nlme

Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse

This is mgcv 1.9-3. For overview type 'help("mgcv-package")'.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(GGally)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Path{-}to{-}data, /data/datasets.csv}
\NormalTok{ucla }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./data/UCLA2023{-}2024.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Rows: 31775 Columns: 198
-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (40): Date, Pitcher, PitcherThrows, PitcherTeam, Batter, BatterSide, B...
dbl  (148): PitchNo, PAofInning, PitchofPA, PitcherId, BatterId, Inning, Out...
lgl    (4): MeasuredDuration, PitchLastMeasuredX, PitchLastMeasuredY, PitchL...
dttm   (2): LocalDateTime, UTCDateTime
time   (4): Time, Tilt, UTCTime, SpinAxis3dTilt

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penn }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./data/PennState2024.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Rows: 8539 Columns: 198
-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (38): Pitcher, PitcherThrows, PitcherTeam, Batter, BatterSide, BatterT...
dbl  (127): PitchNo, PAofInning, PitchofPA, PitcherId, BatterId, Inning, Out...
lgl   (25): Notes, MeasuredDuration, PitchLastMeasuredX, PitchLastMeasuredY,...
dttm   (2): LocalDateTime, UTCDateTime
date   (2): Date, UTCDate
time   (4): Time, Tilt, UTCTime, SpinAxis3dTilt

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{purdue }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./data/Purdue2024.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Rows: 11288 Columns: 198
-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (38): Pitcher, PitcherThrows, PitcherTeam, Batter, BatterSide, BatterT...
dbl  (117): PitchNo, PAofInning, PitchofPA, PitcherId, BatterId, Inning, Out...
lgl   (36): Notes, MeasuredDuration, PitchLastMeasuredX, PitchLastMeasuredY,...
dttm   (2): LocalDateTime, UTCDateTime
date   (2): Date, UTCDate
time   (3): Time, Tilt, UTCTime

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{michigan }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./data/Michigan2024.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Rows: 10202 Columns: 198
-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (39): Pitcher, PitcherThrows, PitcherTeam, Batter, BatterSide, BatterT...
dbl  (117): PitchNo, PAofInning, PitchofPA, PitcherId, BatterId, Inning, Out...
lgl   (35): MeasuredDuration, PitchLastMeasuredX, PitchLastMeasuredY, PitchL...
dttm   (2): LocalDateTime, UTCDateTime
date   (2): Date, UTCDate
time   (3): Time, Tilt, UTCTime

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Need to convert from character to date object}
\NormalTok{ucla }\OtherTok{\textless{}{-}}\NormalTok{ ucla }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Date =} \FunctionTok{as.Date}\NormalTok{(Date)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{UTCDate =} \FunctionTok{as.Date}\NormalTok{(UTCDate)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{AwayTeamForeignID =} \FunctionTok{as.character}\NormalTok{(AwayTeamForeignID))}

\CommentTok{\# The data set that we will be mutating}
\NormalTok{main }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(ucla, penn, michigan, purdue)}
\end{Highlighting}
\end{Shaded}

Cleaning:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filtered\_vars }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{"Pitcher"}\NormalTok{,}
  \StringTok{"PitcherId"}\NormalTok{,}
  \StringTok{"PitcherThrows"}\NormalTok{,}
  \StringTok{"TaggedPitchType"}\NormalTok{,}
  \StringTok{"RelSpeed"}\NormalTok{,           }\CommentTok{\# Speed at release}
  \StringTok{"ZoneSpeed"}\NormalTok{,          }\CommentTok{\# Speed at the plate}
  \StringTok{"EffectiveVelo"}\NormalTok{,      }\CommentTok{\# Perceived pitch speed}
  \StringTok{"ZoneTime"}\NormalTok{,           }\CommentTok{\# Time to reach plate}
  \StringTok{"SpeedDrop"}\NormalTok{,          }\CommentTok{\# Velo loss from release to plate}
  \StringTok{"VertBreak"}\NormalTok{,          }\CommentTok{\# Full vertical break}
  \StringTok{"InducedVertBreak"}\NormalTok{,   }\CommentTok{\# Break excluding gravity}
  \StringTok{"HorzBreak"}\NormalTok{,          }\CommentTok{\# Horizontal movement}
  \StringTok{"SpinRate"}\NormalTok{,           }\CommentTok{\# Raw spin}
  \StringTok{"SpinAxis"}\NormalTok{,           }\CommentTok{\# 0â€“360 spin axis}
  \StringTok{"RelHeight"}\NormalTok{,          }\CommentTok{\# Release height}
  \StringTok{"RelSide"}\NormalTok{,            }\CommentTok{\# Horizontal release side}
  \StringTok{"Extension"}\NormalTok{,          }\CommentTok{\# Distance toward plate}
  \StringTok{"VertApprAngle"}\NormalTok{,      }\CommentTok{\# Vertical approach angle}
  \StringTok{"HorzApprAngle"}\NormalTok{,      }\CommentTok{\# Horizontal approach angle}
  \StringTok{"VertRelAngle"}\NormalTok{,       }\CommentTok{\# Vertical release angle}
  \StringTok{"HorzRelAngle"}\NormalTok{,       }\CommentTok{\# Horizontal release angle}
  \StringTok{"PlateLocHeight"}\NormalTok{,     }\CommentTok{\# Raw vertical location}
  \StringTok{"PlateLocSide"}\NormalTok{,       }\CommentTok{\# Raw horizontal location}
  \StringTok{"Balls"}\NormalTok{,              }\CommentTok{\# Balls}
  \StringTok{"Strikes"}\NormalTok{,            }\CommentTok{\# Strikes}
  \StringTok{"Inning"}\NormalTok{,}
  \StringTok{"Outs"}\NormalTok{,               }\CommentTok{\# Outs}
  \StringTok{"Batter"}\NormalTok{,}
  \StringTok{"BatterTeam"}\NormalTok{,}
  \StringTok{"BatterSide"}\NormalTok{,         }\CommentTok{\# Bats L/R}
  \StringTok{"PAofInning"}\NormalTok{,         }\CommentTok{\# Plate Appearance of Inning}
  \StringTok{"PitchofPA"}\NormalTok{,          }\CommentTok{\# Pitch of Plate Appearance}
  \StringTok{"PitchNo"}\NormalTok{,            }\CommentTok{\# Pitch number of the game}
  \StringTok{"PitchReleaseConfidence"}\NormalTok{, }\CommentTok{\# Trackman tracking confidence level}
  \StringTok{"PitchLocationConfidence"}\NormalTok{, }\CommentTok{\# Trackman tracking confidence level}
  \StringTok{"PitchMovementConfidence"} \CommentTok{\# Trackman tracking confidence level}
\NormalTok{)}

\NormalTok{main }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(filtered\_vars)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\SpecialCharTok{\textasciitilde{}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(.)))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\AttributeTok{names\_to =} \StringTok{"column"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"na\_count"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(na\_count))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 36 x 2
   column                  na_count
   <chr>                      <int>
 1 EffectiveVelo                669
 2 SpeedDrop                    669
 3 PitchReleaseConfidence       664
 4 PitchLocationConfidence      664
 5 PitchMovementConfidence      664
 6 SpinRate                     550
 7 VertBreak                    545
 8 InducedVertBreak             545
 9 HorzBreak                    545
10 SpinAxis                     545
# i 26 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{drop\_na}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(filtered\_vars)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(UTCDateTime, PitchNo)}
\end{Highlighting}
\end{Shaded}

Variable Transformations:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Creating an ID}
\NormalTok{main }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{DatasetID =} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{n}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# making IDs}
  \FunctionTok{relocate}\NormalTok{(DatasetID, }\AttributeTok{.before=}\NormalTok{PitchNo) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{SpinAxis\_rad =}\NormalTok{ SpinAxis }\SpecialCharTok{*}\NormalTok{ pi }\SpecialCharTok{/} \DecValTok{180}\NormalTok{,}
    \AttributeTok{SpinAxis\_sin =} \FunctionTok{sin}\NormalTok{(SpinAxis\_rad),}
    \AttributeTok{SpinAxis\_cos =} \FunctionTok{cos}\NormalTok{(SpinAxis\_rad),}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{relocate}\NormalTok{(SpinAxis\_rad, SpinAxis\_sin, SpinAxis\_cos, }\AttributeTok{.after=}\NormalTok{SpinAxis) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Spin Axis to sin/cos component \%\textgreater{}\% }
  \CommentTok{\# mutate(}
  \CommentTok{\#   BatterSide = ifelse(BatterSide == "Right", 1, 0),}
  \CommentTok{\#   PitcherThrows = ifelse(PitcherThrows == "Right", 1, 0)}
  \CommentTok{\# ) \%\textgreater{}\%}
  \CommentTok{\# mutate(BatterSide = factor(BatterSide)) \%\textgreater{}\% \# Batterside and PitcherThrows to binary: 1 {-} right 0 {-} left}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Count =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(Balls, }\StringTok{"{-}"}\NormalTok{, Strikes))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{relocate}\NormalTok{(Count, }\AttributeTok{.after=}\NormalTok{Strikes) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Creating a factor of counts}
  \CommentTok{\# mutate(Outs = factor(Outs), Inning = factor(Inning)) \%\textgreater{}\% \# Creating a factor for outs and innings}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{RelSide =} \FunctionTok{abs}\NormalTok{(RelSide)) }\CommentTok{\# Standardize the rel{-}side for righties and lefties}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(main)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 204
  DatasetID PitchNo Date   Time   PAofInning PitchofPA Pitcher        PitcherId
      <int>   <dbl> <date> <time>      <dbl>     <dbl> <chr>              <dbl>
1         1      23 NA     14:27           1         4 Riedel, Caleb 1000120428
2         2      23 NA     14:27           1         4 Riedel, Caleb 1000120428
3         3      24 NA     14:49           1         5 Riedel, Caleb 1000120428
4         4      24 NA     14:49           1         5 Riedel, Caleb 1000120428
5         5      25 NA     15:09           1         6 Riedel, Caleb 1000120428
6         6      25 NA     15:09           1         6 Riedel, Caleb 1000120428
# i 196 more variables: PitcherThrows <chr>, PitcherTeam <chr>, Batter <chr>,
#   BatterId <dbl>, BatterSide <chr>, BatterTeam <chr>, PitcherSet <chr>,
#   Inning <dbl>, Top_Bottom <chr>, Outs <dbl>, Balls <dbl>, Strikes <dbl>,
#   Count <fct>, TaggedPitchType <chr>, AutoPitchType <chr>, PitchCall <chr>,
#   KorBB <chr>, TaggedHitType <chr>, PlayResult <chr>, OutsOnPlay <dbl>,
#   RunsScored <dbl>, Notes <chr>, RelSpeed <dbl>, VertRelAngle <dbl>,
#   HorzRelAngle <dbl>, SpinRate <dbl>, SpinAxis <dbl>, SpinAxis_rad <dbl>, ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_csv}\NormalTok{(main, }\StringTok{"stuff\_data\_full\_raw.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Per Pitch Transformations

Fastball

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(TaggedPitchType) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Count =} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Count))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 13 x 2
   TaggedPitchType  Count
   <chr>            <int>
 1 Fastball         26352
 2 Slider           13174
 3 ChangeUp          6843
 4 Sinker            5263
 5 Curveball         4332
 6 FourSeamFastBall  1725
 7 Cutter            1648
 8 Undefined         1359
 9 Splitter           167
10 TwoSeamFastBall     72
11 Other               66
12 OneSeamFastBall     19
13 Knuckleball          5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main\_fb }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(TaggedPitchType }\SpecialCharTok{==} \StringTok{"Fastball"} \SpecialCharTok{|}\NormalTok{ TaggedPitchType }\SpecialCharTok{==} \StringTok{"FourSeamFastBall"}\NormalTok{)}

\CommentTok{\# Training the models for residual normalization}
\CommentTok{\# Vertical Approach Angle}
\NormalTok{vaa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_fb }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(VertApprAngle, RelHeight, PlateLocHeight)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(VertApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ vaa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{vaa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Subset the data}
\NormalTok{haa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_fb }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(HorzApprAngle, RelSide, PlateLocSide)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(HorzApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ haa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{haa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaa\_gam }\OtherTok{\textless{}{-}} \FunctionTok{gam}\NormalTok{(VertApprAngle }\SpecialCharTok{\textasciitilde{}} \FunctionTok{s}\NormalTok{(RelHeight) }\SpecialCharTok{+}\NormalTok{ PlateLocHeight, }\AttributeTok{data =}\NormalTok{ vaa\_df\_std }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(VertApprAngle, RelHeight, PlateLocHeight))}
\FunctionTok{summary}\NormalTok{(vaa\_gam)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Family: gaussian 
Link function: identity 

Formula:
VertApprAngle ~ s(RelHeight) + PlateLocHeight

Parametric coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)    -5.436957   0.002586 -2102.6   <2e-16 ***
PlateLocHeight  1.020711   0.002597   393.1   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
               edf Ref.df    F p-value    
s(RelHeight) 8.758  8.983 1668  <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.854   Deviance explained = 85.4%
GCV = 0.18781  Scale est. = 0.18774   n = 28077
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(vaa\_gam, }\AttributeTok{pages =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-7-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train\_control }\OtherTok{\textless{}{-}} \FunctionTok{trainControl}\NormalTok{(}
  \AttributeTok{method =} \StringTok{"cv"}\NormalTok{,}
  \AttributeTok{number =} \DecValTok{10}\NormalTok{,}
  \AttributeTok{verboseIter =} \ConstantTok{TRUE}
\NormalTok{)}

\NormalTok{tune\_grid }\OtherTok{\textless{}{-}} \FunctionTok{expand.grid}\NormalTok{(}
  \AttributeTok{nrounds =} \DecValTok{100}\NormalTok{,}
  \AttributeTok{max\_depth =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{eta =} \FloatTok{0.1}\NormalTok{,}
  \AttributeTok{gamma =} \DecValTok{0}\NormalTok{,}
  \AttributeTok{colsample\_bytree =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{min\_child\_weight =} \DecValTok{5}\NormalTok{,}
  \AttributeTok{subsample =} \FloatTok{0.8}
\NormalTok{)}

\NormalTok{xgb\_model }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(}
\NormalTok{  HorzApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .,}
  \AttributeTok{data =}\NormalTok{ haa\_df,}
  \AttributeTok{method =} \StringTok{"xgbTree"}\NormalTok{,           }\CommentTok{\# caret\textquotesingle{}s XGBoost wrapper}
  \AttributeTok{trControl =}\NormalTok{ train\_control,}
  \AttributeTok{tuneGrid =}\NormalTok{ tune\_grid,}
  \AttributeTok{metric =} \StringTok{"RMSE"}               \CommentTok{\# or MAE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
+ Fold01: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold01: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold02: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold02: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold03: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold03: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold04: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold04: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold05: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold05: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold06: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold06: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold07: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold07: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold08: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold08: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold09: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold09: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
+ Fold10: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
- Fold10: nrounds=100, max_depth=3, eta=0.1, gamma=0, colsample_bytree=1, min_child_weight=5, subsample=0.8 
Aggregating results
Fitting final model on full training set
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(xgb\_model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
eXtreme Gradient Boosting 

28077 samples
    2 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 25269, 25269, 25270, 25270, 25270, 25269, ... 
Resampling results:

  RMSE       Rsquared   MAE      
  0.9309982  0.5268024  0.6827704

Tuning parameter 'nrounds' was held constant at a value of 100
Tuning
 held constant at a value of 5
Tuning parameter 'subsample' was held
 constant at a value of 0.8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Vertical Approach Angle: }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Vertical Approach Angle: 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vert\_hat }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(vaa\_gam, }\AttributeTok{newdata =}\NormalTok{ vaa\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(RelHeight, PlateLocHeight))}
\FunctionTok{summary}\NormalTok{(vert\_hat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-11.957  -7.730  -7.046  -7.042  -6.366  -1.947 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{VertApprAngle)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-10.6266  -6.1821  -5.4315  -5.4370  -4.6933  -0.2167 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Horizontal Approach Angle: }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Horizontal Approach Angle: 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horz\_hat }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(xgb\_model, }\AttributeTok{newdata =}\NormalTok{ haa\_df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(RelSide, PlateLocSide))}
\FunctionTok{summary}\NormalTok{(horz\_hat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-6.7548 -1.0819 -0.4421 -0.4443  0.1789  3.5111 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{HorzApprAngle)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-9.9787 -1.3354 -0.4653 -0.4441  0.4195  6.5188 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main\_fb }\OtherTok{\textless{}{-}}\NormalTok{ main\_fb }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{HorzApprAngle\_n =} \FunctionTok{as.numeric}\NormalTok{(HorzApprAngle }\SpecialCharTok{{-}}\NormalTok{ horz\_hat),}
         \AttributeTok{VertApprAngle\_n =} \FunctionTok{as.numeric}\NormalTok{(VertApprAngle }\SpecialCharTok{{-}}\NormalTok{ vert\_hat)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{relocate}\NormalTok{(HorzApprAngle\_n, VertApprAngle\_n, }\AttributeTok{.before=}\NormalTok{VertApprAngle)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Normalized Value Summary: }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Normalized Value Summary: 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Horz: }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Horz: 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{HorzApprAngle\_n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-5.647031 -0.559345 -0.141828  0.000202  0.387886  4.589873 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Vert: }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Vert: 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{VertApprAngle\_n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -2.309   1.329   1.652   1.605   1.944   2.844 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{haa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_fb}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(vaa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-8-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(haa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-8-2.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_csv}\NormalTok{(main\_fb, }\StringTok{"stuff\_data\_fastball\_transformed.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Slider

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main\_sl }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(TaggedPitchType }\SpecialCharTok{==} \StringTok{"Slider"}\NormalTok{)}

\CommentTok{\# Training the models for residual normalization}
\CommentTok{\# Vertical Approach Angle}
\NormalTok{vaa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_sl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(VertApprAngle, RelHeight, PlateLocHeight)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(VertApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ vaa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{vaa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Horz Appr Angle}
\NormalTok{haa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_sl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(HorzApprAngle, RelSide, PlateLocSide)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(HorzApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ haa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{haa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_sl}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{haa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_sl}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(vaa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-10-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(haa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-10-2.pdf}}

Curveball

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main\_cv }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(TaggedPitchType }\SpecialCharTok{==} \StringTok{"Curveball"}\NormalTok{)}

\CommentTok{\# Training the models for residual normalization}
\CommentTok{\# Vertical Approach Angle}
\NormalTok{vaa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_cv }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(VertApprAngle, RelHeight, PlateLocHeight)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(VertApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ vaa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{vaa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Horz Appr Angle}
\NormalTok{haa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_cv }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(HorzApprAngle, RelSide, PlateLocSide)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(HorzApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ haa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{haa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_cv}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{haa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_cv}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\FunctionTok{summary}\NormalTok{(vaa\_df\_std)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   RelHeight        PlateLocHeight      VertApprAngle     PitcherSide 
 Min.   :-6.23049   Min.   :-3.589006   Min.   :-15.395   Left : 821  
 1st Qu.:-0.76861   1st Qu.:-0.655917   1st Qu.:-10.665   Right:3511  
 Median : 0.04177   Median :-0.005278   Median : -9.620               
 Mean   : 0.00000   Mean   : 0.000000   Mean   : -9.675               
 3rd Qu.: 0.80798   3rd Qu.: 0.631407   3rd Qu.: -8.639               
 Max.   : 3.22582   Max.   : 4.597795   Max.   : -3.752               
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(haa\_df\_std)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    RelSide          PlateLocSide       HorzApprAngle      PitcherSide 
 Min.   :-2.26844   Min.   :-5.144991   Min.   :-10.4531   Left : 821  
 1st Qu.:-0.53152   1st Qu.:-0.617734   1st Qu.: -2.9172   Right:3511  
 Median :-0.02436   Median : 0.009133   Median : -1.8499               
 Mean   : 0.00000   Mean   : 0.000000   Mean   : -1.3526               
 3rd Qu.: 0.50834   3rd Qu.: 0.638070   3rd Qu.: -0.3644               
 Max.   : 4.53182   Max.   : 4.854398   Max.   :  7.7244               
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(vaa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-11-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(haa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-11-2.pdf}}

Changeup

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{main\_chg }\OtherTok{\textless{}{-}}\NormalTok{ main }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(TaggedPitchType }\SpecialCharTok{==} \StringTok{"ChangeUp"}\NormalTok{)}

\CommentTok{\# Training the models for residual normalization}
\CommentTok{\# Vertical Approach Angle}
\NormalTok{vaa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_chg }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(VertApprAngle, RelHeight, PlateLocHeight)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(VertApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ vaa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{vaa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Horz Appr Angle}
\NormalTok{haa\_df }\OtherTok{\textless{}{-}}\NormalTok{ main\_chg }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(HorzApprAngle, RelSide, PlateLocSide)}
\NormalTok{rec }\OtherTok{\textless{}{-}} \FunctionTok{recipe}\NormalTok{(HorzApprAngle }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ haa\_df) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{step\_normalize}\NormalTok{(}\FunctionTok{all\_numeric\_predictors}\NormalTok{())     }\CommentTok{\# Normalize (center \& scale)}
\NormalTok{rec\_prepped }\OtherTok{\textless{}{-}} \FunctionTok{prep}\NormalTok{(rec)}
\NormalTok{haa\_df\_std }\OtherTok{\textless{}{-}} \FunctionTok{bake}\NormalTok{(rec\_prepped, }\AttributeTok{new\_data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_chg}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\NormalTok{haa\_df\_std}\SpecialCharTok{$}\NormalTok{PitcherSide }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(main\_chg}\SpecialCharTok{$}\NormalTok{PitcherThrows)}
\FunctionTok{summary}\NormalTok{(vaa\_df\_std)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   RelHeight        PlateLocHeight     VertApprAngle     PitcherSide 
 Min.   :-6.45777   Min.   :-5.44927   Min.   :-15.089   Left :1596  
 1st Qu.:-0.61102   1st Qu.:-0.64412   1st Qu.: -8.255   Right:5247  
 Median :-0.07302   Median : 0.01625   Median : -7.440               
 Mean   : 0.00000   Mean   : 0.00000   Mean   : -7.466               
 3rd Qu.: 0.54859   3rd Qu.: 0.63201   3rd Qu.: -6.696               
 Max.   : 3.81439   Max.   : 6.96149   Max.   : -2.401               
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(haa\_df\_std)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    RelSide         PlateLocSide       HorzApprAngle     PitcherSide 
 Min.   :-2.5363   Min.   :-3.927725   Min.   :-6.3511   Left :1596  
 1st Qu.:-0.6840   1st Qu.:-0.659262   1st Qu.:-1.1169   Right:5247  
 Median :-0.1032   Median : 0.005033   Median :-0.2112               
 Mean   : 0.0000   Mean   : 0.000000   Mean   :-0.2896               
 3rd Qu.: 0.6016   3rd Qu.: 0.657869   3rd Qu.: 0.5683               
 Max.   : 4.8724   Max.   : 4.284880   Max.   : 6.0070               
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(vaa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-12-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggp }\OtherTok{\textless{}{-}} \FunctionTok{ggpairs}\NormalTok{(haa\_df\_std, }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ PitcherSide),}
        \AttributeTok{progress =}\NormalTok{ F)}
\FunctionTok{print}\NormalTok{(ggp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{stuff_pipeline_files/figure-pdf/unnamed-chunk-12-2.pdf}}




\end{document}
